# 输入域名到网页渲染完成


![渲染过程](http://43.139.113.7:81/img/browser.jpeg)
<!-- https://img-blog.csdnimg.cn/img_convert/fa64c09fc563b8a799255609bb0f91bb.png -->

**1. 请求阶段**
- 客户端(浏览器)输入目标网址
- DNS解析, 获取目标网址对应的ip地址**
- 建立HTTP或者HTTPS，向服务端请求页面, TCP协议的三次握手和四次挥手**

**2. 响应阶段**
- HTTP状态码
- 304缓存
- HTTP报文

**3. 渲染阶段**

- 得到代码后，开辟一块栈内存来给代码的执行提供环境, 同时分配一个线程去一行行的执行和解析代码。进栈执行, 执行完后出栈。这也就是JS的单线程执行方式。
- 在代码的执行中, 可能会遇到link/script/img标签, 都会开辟全新的线程去加载资源文件。也称为TASK QUEUE(任务队列)。
- 在html文件自上而下执行完后, 即生成了DOM树, 随后会去任务队列中查看哪些资源文件加载完毕, 将加载完毕的资源文件引入到栈内存中继续执行。引入到内存中的资源文件执行完毕后, 又会重复以上操作, 直到任务队列中的任务全部执行完毕。该过程也被称为Event Loop(事件循环), 任务队列中的任务会被分为微任务和宏任务。
- CSS处理完成后生成CSSOM。
- DOM树和CSSOM结合生成Render Tree(渲染树)
- Layout回流: 根据生成的渲染树, 计算它们在设备视口内的确切位置和大小, 这个计算的阶段就是回流。
- Painting重绘: 根据渲染树以及回流得到的几何信息, 得到节点的绝对像素。
- Display: 将像素发送给GPU, 展示在页面上。

**4. 性能优化**

减少HTTP请求次数和大小, 资源合并压缩, 多个CSS合并为一个, 多张图片合并为一张雪碧图。
图片懒加载, 音视频走流文件, 减少DOM操作, 减少回流的操作, 分离读写减少回流, 运用文档碎片减少dom操作, transform不会引起回流的操作, 

## DNS查询

参考：[阮一峰 - DNS查询原理](https://www.ruanyifeng.com/blog/2022/08/dns-query.html)
域名对应的 IP 地址，都保存在 DNS 服务器。<br>
我们输入域名，浏览器就会在后台，自动向 DNS 服务器发出请求，获取对应的 IP 地址。这就是 DNS 查询。<br>
